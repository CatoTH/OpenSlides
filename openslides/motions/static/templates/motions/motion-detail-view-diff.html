
<div ng-if="viewChangeRecommendations.mode == 'diff'">
    <ng-include src="'static/templates/motions/motion-detail-change-summary.html'"></ng-include>

    <!-- The actual diff view -->
    <div ng-repeat="change in (changes = (change_recommendations | filter:{motion_version_id:version}:true | orderBy: 'line_from')) ">
        <div class="motion-text original-text line-numbers-{{ lineNumberMode }}"
             ng-bind-html="motion.getTextBetweenChangeRecommendations(version, changes[$index - 1], change) | trusted"></div>

        <div class="diff-box diff-box-{{ change.id }}">
            <div class="action-row" ng-if="motion.isAllowed('can_manage')">
                <label class="radio-inline">
                    <input type="radio" name="changeRecommendationStatus[{{ change.id }}]" value="0"
                           ng-change="change.saveStatus()" ng-model="change.status" ng-checked="change.status == 0">
                    <translate>Suggested</translate>
                </label>
                <label class="radio-inline">
                    <input type="radio" name="changeRecommendationStatus[{{ change.id }}]" value="1"
                           ng-change="change.saveStatus()" ng-model="change.status" ng-checked="change.status == 1">
                    <translate>Accepted</translate>
                </label>
                <label class="radio-inline">
                    <input type="radio" name="changeRecommendationStatus[{{ change.id }}]" value="2"
                           ng-change="change.saveStatus()" ng-model="change.status" ng-checked="change.status == 2">
                    <translate>Rejected</translate>
                </label>

                <button class="btn btn-default btn-xs pull-right"
                        ng-bootbox-confirm="{{ 'Are you sure you want to delete this change recommendation?' | translate }}"
                        ng-bootbox-confirm-action="viewChangeRecommendations.delete(change.id)"
                        title="{{ 'Delete' | translate }}">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="status-row" ng-if="!motion.isAllowed('can_manage')">
                <span ng-if="change.status == 0"><translate>Suggested</translate></span>
                <span ng-if="change.status == 1"><translate>Accepted</translate></span>
                <span ng-if="change.status == 2"><translate>Rejected</translate></span>
            </div>

            <div class="motion-text motion-text-diff line-numbers-{{ lineNumberMode }}"
                 ng-bind-html="viewChangeRecommendations.formatChangeRecommendation(motion, version, change) | trusted"></div>
        </div>
    </div>

    <div class="motion-text original-text line-numbers-{{ lineNumberMode }}"
         ng-bind-html="motion.getTextRemainderAfterLastChangeRecommendation(version, changes) | trusted"></div>
</div>